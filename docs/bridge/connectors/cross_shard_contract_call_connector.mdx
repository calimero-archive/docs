---
title: Cross Shard Contract Call Connector
sidebar_position: 4
---

The Calimero bridge enables the execution of cross shard calls with a callback. This means that a contract on the Calimero shard can call contracts on NEAR and vice versa, receiving a callback in return.

To set up the bridge and fulfill the prerequisites, refer to the [Running a Bridge](https://docs.calimero.network/bridge/running_a_bridge) section.

## Setting up the xsc_connectors

On the `xsc_connector` contract, the contract owner needs to set the locker account, which refers to the `xsc_connector` contract on the other chain. This information is utilized to verify that a transaction/receipt occurred on the corresponding`xsc_connector` contract of the other network.

## Executing a cross shard contract call

To execute a call into a contract on another chain, the DAPP needs to make a `cross_call` invocation on the `xsc_connector` contract. The following method should be called:

```rust
pub fn cross_call(
  &mut self,
  destination_contract_id: String,
  destination_contract_method: String,
  destination_contract_args: String,
  destination_gas: Gas,
  destination_deposit: Balance,
  source_callback_method: String,
) 
```

- `destination_contract_id`: The contract ID on the other chain to which the call is intended.
- `destination_contract_method`: The method to be called on the destination contract.
- `destination_contract_args` : The arguments provided to the method, serialized as JSON.
- `destination_gas`: The amount of gas allocated for the execution on the other network.
- `destination_deposit`: The deposit amount for the destination contract.
- `source_callback_method`: The name of the callback method within the contract from which the cross call originates.

When executed, the `cross_call` will emit a `CALIMERO_EVENT_CROSS_CALL` event with all the provided input parameters appended to the event.


The indexer detects this event and populates the message queue. The relayer and bridge service subscribe to Calimero-specific events in the message queue. Both components receive the event simultaneously. The relayer sends a block from the source chain to the light client contract on the destination chain with the latest light client block. Simultaneously, the bridge service fetches the RPC for `EXPERIMENTAL_light_client_proof` and queries the light client contract for the latest block height it possesses. Using the proof data and block height, the bridge service calls the xsc_connector on the other network, specifically invoking the `cross_call_execute` method. If it is proven that a cross call was initiated on the other network, the `xsc_connector` will execute the specified method on the contract residing on the other chain.


## Callback execution

Once the `cross_call_execute` method executes the call on the contract of the other chain `CALIMERO_EVENT_CROSS_RESPONSE` event is emitted on that chain.

The event includes the appended parameters: `source_contract_id`, the `source_contract_method` and the `execution_result` which is base64 encoded.

Through the bridge service, this event is proven on the originating chain, and the callback arguments are provided to the original smart contract that initiated the cross call.

Thus, the entire cycle is complete: a contract on Chain A called a contract method on Chain B and received a callback with the result from executing the contract method on Chain B back on Chain A.