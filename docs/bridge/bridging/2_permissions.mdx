---
title: Bridge permissions management
sidebar_position: 2
---


When using the Calimero bridge to transfer FTs, NFTs, or make cross-shard calls, it is crucial to set up permissions properly. Permissions are managed on a connector basis for both the Near and Calimero sides.

### Permissions for FT Connector

- Initially, all FT bridging is denied in both directions.
- To allow bridging from Near to Calimero, a regex rule is added on the Near side. This rule should match the desired Account ID that wants to bridge FTs to Calimero.
- Examples of regex rules:
  - `john\.testnet` allows only `john.testnet` to bridge FTs (excluding `doe.john.testnet`).
  - `.*john\.testnet` allows any Account ID ending with `john.testnet` to bridge FTs.
  - `.*\.john\.testnet` allows any sub-account of `john.testnet` to bridge FTs.
  - `.*john.*` allows any Account ID containing `john` to bridge FTs.
  - `.*\.testnet` allows any Testnet Account to bridge FTs.
- When the `ft_on_transfer` method is called, it checks if the original account has bridging permissions based on the allow rules. If there is a match, bridging is allowed.

### Permissions for NFT Connector

- NFT connector permissions are managed in the same manner as FT connectors.
- Initially, all accounts are denied for bridging NFTs.
- With the NFT connectors key from the destination side, regex rule transactions are signed.
- When the `nft_on_transfer` method is called, it checks if the original account has bridging permissions based on the allow rules. The Account ID must match at least one NFT allow rule on that side.

### Permissions for Cross Shard Call Connector (XSC)

- XSC permissions are managed separately for the Near and Calimero sides.
- XSC permissions have two parts: an account allow list and a deny list of account-contract pairs.
- Initially, all accounts are denied for calling any smart contract on the other side.
- To make a cross-shard call, the Account ID on the Near side needs to pass both the allow list and deny list checks.
- The Account ID must match at least one allow regex rule for XSC.
- Additionally, the Account ID and Contract ID pair should not match any deny regex pair rules to be allowed for cross-shard calls.
- An example of deny list rule: [`.*secret.*`, `.*`] means no account can call any smart contract with `secret` in its name.

### Managing Bridge Permissions

Bridge permissions can be managed in three ways:

1. **Calimero Console UI**: Use the Calimero Console UI to manage permissions.
2. **Calimero Bridge SDK**: Utilize the Calimero Bridge SDK for permissions management.
3. **CLI**: Directly manage permissions through the command-line interface.

## Security and Motivation

Properly setting bridge permissions is crucial for several reasons:

1. **Preventing Malicious Bridging**: Setting permissions ensures that malicious entities cannot bridge FTs/NFTs into the private shard.
2. **Preserving Privacy**: Cross Shard Calls require complex permissions management to prevent the leakage of private information from contracts on the private shard.
3. **Avoiding Unwanted Gas Fees**: Setting permissions correctly prevents malicious actors from causing financial harm to shard owners by initiating a large number of bridging operations and incurring gas fees paid by the shard owner.
4. **Protecting Against Asset Acquisition**: Improper permissions can allow attackers to come into possession of a small amount of assets paid for malicious Cross Shard Calls.

:::info
Set Bridge permissions as strictly as possible to remove possible attack vectors and ensure secure bridging operations.
:::


To mitigate these risks, it is essential to set bridge permissions as strictly as possible without compromising necessary bridge functionality.


